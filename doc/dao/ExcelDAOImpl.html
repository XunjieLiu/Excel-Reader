<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.2) on Mon Apr 22 21:47:55 CST 2019 -->
<title>ExcelDAOImpl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2019-04-22">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
<script type="text/javascript" src="../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ExcelDAOImpl";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ExcelDAOImpl.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">dao</a></div>
<h2 title="Class ExcelDAOImpl" class="title">Class ExcelDAOImpl</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>dao.ExcelDAOImpl</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="IExcelDAO.html" title="interface in dao">IExcelDAO</a></code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">ExcelDAOImpl</span>
extends java.lang.Object
implements <a href="IExcelDAO.html" title="interface in dao">IExcelDAO</a></pre>
<div class="block">An implementation of the <code>IExcelDAO</code> interface. In addition to
 implementing the <code>IExcelDAO</code> interface, this class provides methods to
 extract data from XSSFRow objects to String arrays.
 
 <p>
 Although the function of this class is to read data from Excel files rather
 than real database like MySQL or Oracle, it still could be available for Data
 Access Object design model, but situations would be a little different.
 Normally TweetDAO and UserDAO should be totally seperated and they should
 have their database opeartion methods, but since that this is a excel file
 containing 210000 records, intensive computation resource and memory resource
 are needed to do a single traverse. Therefore, traverse time should be only
 one and for each record read into the memory, TweetDAO and UserDAO should
 both be called so that one traverse would enough for everything, because data
 access would be more efficient and fast within java data structure rather
 than excel files.
 
 <p>
 The <code>getAllTweets</code>, <code>getAllUsers</code> return its global variables to
 <a href="../service/Menu.html" title="class in service"><code>Menu</code></a>
 
 <p>
 In order to sort object easily, <code>PriorityQueue</code> is used to sort
 compareble objects. Tweet and User object in <a href="../entity/Tweet.html" title="class in entity"><code>Tweet</code></a> and
 <a href="../entity/User.html" title="class in entity"><code>User</code></a> have implemented Comparable interface according to
 their own attributes.
 
 <p>
 Besides, this class use external jar packages from Apache POI to parse Excel
 files, and its model is User Model rather than Event Model. See <a href="http://poi.apache.org/components/spreadsheet/quick-guide.html#CellContents">Busy
 Developers' Guide to HSSF and XSSF Features</a>.
 
 <p>
 Efficiency and robustness are implemented through reduce dependency between
 different classes and packages, each class should only implement one specific
 function. This class only responsible for read raw data from excel files, and
 then ExcelDAO object will focus on the next move. External jar package will
 be only needed for this class.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2019-03-20</dd>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>1.0</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Xunjie Liu</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="IExcelDAO.html" title="interface in dao"><code>IExcelDAO</code></a>, 
<a href="http://poi.apache.org/components/spreadsheet/quick-guide.html#CellContents">Busy
      Developers' Guide to HSSF and XSSF Features</a>.</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">ExcelDAOImpl</a></span>()</code></th>
<td class="colLast">
<div class="block">Constructs an instance of ExcelDAOImpl object and initial cell daos to read
 data, due to the requirements of this coursework, all main function needed to
 do is create a new instance of ExcelDAOImpl, and then data extracting work
 would be started automatically.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>java.util.PriorityQueue&lt;<a href="../entity/Tweet.html" title="class in entity">Tweet</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getAllTweets()">getAllTweets</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns all Tweet objects, classes on <b>Controller</b> layer would only need to invoke this method and <a href="#getAllUsers()"><code>getAllUsers()</code></a>,
 so that all data access operations are encapsulated in <b>Model</b> layer.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.util.TreeSet&lt;<a href="../entity/User.html" title="class in entity">User</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getAllUsers()">getAllUsers</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns all User objects,  classes on <b>Controller</b> layer would only need to invoke this method and <a href="#getAllTweets()"><code>getAllTweets()</code></a>,
 so that all data access operations are encapsulated in <b>Model</b> layer.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.lang.String[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRow(org.apache.poi.xssf.usermodel.XSSFRow)">getRow</a></span>&#8203;(org.apache.poi.xssf.usermodel.XSSFRow&nbsp;excel_row)</code></th>
<td class="colLast">
<div class="block">Exact data from XSSFRow instances and return a String array which contains all cells in this row.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#read(dao.IEntityDAO,dao.IEntityDAO)">read</a></span>&#8203;(<a href="IEntityDAO.html" title="interface in dao">IEntityDAO</a>&nbsp;tweetDAO,
    <a href="IEntityDAO.html" title="interface in dao">IEntityDAO</a>&nbsp;userDAO)</code></th>
<td class="colLast">
<div class="block">Exact data from excel files and give them to TweetDAO or UserDAO instance,
 core codes reading data referenc from official demo codes of Apache POI, see
 <a href="http://poi.apache.org/components/spreadsheet/quick-guide.html#CellContents">Busy
 Developers' Guide to HSSF and XSSF Features</a>.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ExcelDAOImpl</h4>
<pre>public&nbsp;ExcelDAOImpl()
             throws org.apache.poi.openxml4j.exceptions.InvalidFormatException,
                    java.io.FileNotFoundException,
                    java.io.IOException</pre>
<div class="block">Constructs an instance of ExcelDAOImpl object and initial cell daos to read
 data, due to the requirements of this coursework, all main function needed to
 do is create a new instance of ExcelDAOImpl, and then data extracting work
 would be started automatically.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>org.apache.poi.openxml4j.exceptions.InvalidFormatException</code></dd>
<dd><code>java.io.FileNotFoundException</code></dd>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="getAllTweets()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllTweets</h4>
<pre class="methodSignature">public&nbsp;java.util.PriorityQueue&lt;<a href="../entity/Tweet.html" title="class in entity">Tweet</a>&gt;&nbsp;getAllTweets()</pre>
<div class="block">Returns all Tweet objects, classes on <b>Controller</b> layer would only need to invoke this method and <a href="#getAllUsers()"><code>getAllUsers()</code></a>,
 so that all data access operations are encapsulated in <b>Model</b> layer.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="IExcelDAO.html#getAllTweets()">getAllTweets</a></code>&nbsp;in interface&nbsp;<code><a href="IExcelDAO.html" title="interface in dao">IExcelDAO</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>PriorityQueue that contains all Tweet objects</dd>
</dl>
</li>
</ul>
<a id="getAllUsers()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllUsers</h4>
<pre class="methodSignature">public&nbsp;java.util.TreeSet&lt;<a href="../entity/User.html" title="class in entity">User</a>&gt;&nbsp;getAllUsers()</pre>
<div class="block">Returns all User objects,  classes on <b>Controller</b> layer would only need to invoke this method and <a href="#getAllTweets()"><code>getAllTweets()</code></a>,
 so that all data access operations are encapsulated in <b>Model</b> layer.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="IExcelDAO.html#getAllUsers()">getAllUsers</a></code>&nbsp;in interface&nbsp;<code><a href="IExcelDAO.html" title="interface in dao">IExcelDAO</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>TreeSet that contains all User objects</dd>
</dl>
</li>
</ul>
<a id="read(dao.IEntityDAO,dao.IEntityDAO)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;read&#8203;(<a href="IEntityDAO.html" title="interface in dao">IEntityDAO</a>&nbsp;tweetDAO,
                 <a href="IEntityDAO.html" title="interface in dao">IEntityDAO</a>&nbsp;userDAO)
          throws org.apache.poi.openxml4j.exceptions.InvalidFormatException,
                 java.io.IOException,
                 java.io.FileNotFoundException</pre>
<div class="block">Exact data from excel files and give them to TweetDAO or UserDAO instance,
 core codes reading data referenc from official demo codes of Apache POI, see
 <a href="http://poi.apache.org/components/spreadsheet/quick-guide.html#CellContents">Busy
 Developers' Guide to HSSF and XSSF Features</a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="IExcelDAO.html#read(dao.IEntityDAO,dao.IEntityDAO)">read</a></code>&nbsp;in interface&nbsp;<code><a href="IExcelDAO.html" title="interface in dao">IExcelDAO</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tweetDAO</code> - tweet cell dao instance</dd>
<dd><code>userDAO</code> - user cell dao instance</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>org.apache.poi.openxml4j.exceptions.InvalidFormatException</code> - If file format is not valid for OPCPackage</dd>
<dd><code>java.io.IOException</code> - If an I/O error occurs, which is possible because the construction of the canonical pathname may require filesystem queries</dd>
<dd><code>java.io.FileNotFoundException</code> - If specified path name is not valid</dd>
</dl>
</li>
</ul>
<a id="getRow(org.apache.poi.xssf.usermodel.XSSFRow)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getRow</h4>
<pre class="methodSignature">public&nbsp;java.lang.String[]&nbsp;getRow&#8203;(org.apache.poi.xssf.usermodel.XSSFRow&nbsp;excel_row)</pre>
<div class="block">Exact data from XSSFRow instances and return a String array which contains all cells in this row.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>excel_row</code> - XSSFRow instances that contains one row data in excel file</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a string array containing all data in one row</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ExcelDAOImpl.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
